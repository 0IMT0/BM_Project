from database_access import database_login
from date_time_GUI import date_selector
import pandas as pd


def bod_data_collector():
    # Get the selected start date, end date, and market type from the GUI
    start_date, end_date = date_selector()
    print(f"Start Date: {start_date}, End Date: {end_date}")

    # Your SQL query with the WHERE clause for the specified date
    sql_bmra_bod = f"""
    SELECT nn, op, bp, vb1, vb2, bmu_id
    FROM public.bmra_bod
    WHERE ts >= '{start_date}' AND ts < '{end_date}';
    """

    # Execute your SQL query and read the data into a DataFrame
    bod_data = pd.read_sql(sql_bmra_bod, database_login())

    # Display DataFrame
    print(bod_data)


def boalf_data_collector():
    # Get the selected start date, end date, and market type from the GUI
    start_date, end_date = date_selector()
    print(f"Start Date: {start_date}, End Date: {end_date}")

    # SQL query with the WHERE clause for the specified time frame
    sql_bmra_boalf = f"""
    SELECT ts, bmu_id 
    FROM public.bmra_boalf
    WHERE ts >= '{start_date}' AND ts < '{end_date}';
    """

    # Execute SQL query and read the data into a DataFrame
    boalf_data = pd.read_sql(sql_bmra_boalf, database_login())
    # Display the filtered DataFrame
    print(boalf_data)


def boalflevel_data_collector():
    # Get the selected start date, end date, and market type from the GUI
    start_date, end_date = date_selector()
    print(f"Start Date: {start_date}, End Date: {end_date}")

    # SQL query with the WHERE clause for the specified time frame
    sql_bmra_boalflevel = f"""
    SELECT ts, va, boalf_id 
    FROM public.bmra_boalflevel
    WHERE ts >= '{start_date}' AND ts < '{end_date}';
    """

    # Execute SQL query and read the data into a DataFrame
    boalf_data = pd.read_sql(sql_bmra_boalflevel, database_login())
    # Display the filtered DataFrame
    print(boalf_data)